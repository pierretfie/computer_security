#check running rdp services
Get-Service -Name TermService


#check is rdp is enabled
(Get-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections").fDenyTSConnections

Expected Output:

    0 = RDP is enabled
    1 = RDP is disabled

    #get 3rd party services
Get-Process | Where-Object { $_.ProcessName -match "TeamViewer|AnyDesk|LogMeIn|VNC|ChromeRemoteDesktop" }

#setting up script to run after every 5mins
üìå Steps to Manually Create the Scheduled Task

1Ô∏è‚É£ Open Task Scheduler (taskschd.msc)
2Ô∏è‚É£ Click "Create Task..." (instead of "Create Basic Task")
3Ô∏è‚É£ General Tab:

    Name: Monitor Remote Access
    Check "Run with highest privileges"
    Choose "Run only when user is logged in" (to make it visible)

4Ô∏è‚É£ Triggers Tab:

    Click New ‚Üí Begin the task: "At startup"
    Check "Delay task for: 30 seconds" (to avoid startup conflicts)
    Click OK

5Ô∏è‚É£ Actions Tab:

    Click New ‚Üí "Start a Program"
    In Program/Script, enter:

    powershell.exe

In Add arguments (optional), enter:

    -ExecutionPolicy Bypass -File "C:\path\to\monitor_remote_connections.ps1"

    Click OK

