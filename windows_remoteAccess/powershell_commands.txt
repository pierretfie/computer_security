#check running rdp services
Get-Service -Name TermService


#check is rdp is enabled
(Get-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections").fDenyTSConnections

Expected Output:

    0 = RDP is enabled
    1 = RDP is disabled

    #get 3rd party services
Get-Process | Where-Object { $_.ProcessName -match "TeamViewer|AnyDesk|LogMeIn|VNC|ChromeRemoteDesktop" }

#setting up script to run after every 5mins
1. create a vbs script
    Set objShell = CreateObject("WScript.Shell")
objShell.Run "powershell.exe -ExecutionPolicy Bypass -File ""C:\Users\eclipse\Desktop\rdpcheck.ps1""", 0, False
